<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title><%= content_for(:title) || "Paddle" %></title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f0f0f0;
      color: #333;
    }

    .container {
      width: 80%;
      max-width: 1000px;
      margin: 0 auto;
      padding-top: 100px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }

    .part {
      width: 100%;
      background-color: #00796b;
      color: rgb(0, 0, 0);
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 10;
      height: 70px;
      box-sizing: border-box;
      width: 100%;
    }

    .logo {
      flex: 1;
      font-size: 24px;
      font-weight: bold;
      letter-spacing: 2px;
    }

    .search-bar {
      flex: 3;
      justify-content: center;
      height: 100%;
    }

    .search-form {
      display: flex;
      align-items: center;
      width: 100%;
      max-width: 800px;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 50px 0 0 50px;
      font-size: 16px;
      outline: none;
    }

    .search-button {
      background-color: #005b4f;
      border: none;
      color: white;
      font-size: 18px;
      padding: 0 15px;
      border-radius: 0 50px 50px 0;
      cursor: pointer;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s ease;
    }

    .search-button:hover {
      background-color: #004239;
    }

    .search-button:focus {
      outline: none;
    }

    /* Profil Sayfası Düzeni */
    .profile-container {
      display: flex;
      justify-content: space-between;
      gap: 30px;
      margin-top: 50px;
    }

    .profile-left {
      flex: 1;
      text-align: left;
    }

    .profile-right {
      flex: 1;
    }

    .profile-picture {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
    }

    .profile-picture img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .profile-username {
      font-size: 28px;
      font-weight: bold;
      margin-top: 15px;
    }

    .profile-description {
      text-align: left;
      font-size: 18px;
      margin-top: 15px;
    }

    .profile-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      gap: 5px;
    }


    .profile-stats {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .profile-stats p {
      margin: 0;
      font-size: 18px;
    }

    .button, .btn-follow, .btn-unfollow, .edit-link, .show-link {
      display: inline-block;
      padding: 10px 18px;
      font-size: 16px;
      color: #fff;
      background-color: #00796b;
      text-decoration: none;
      border-radius: 5px;
      margin-top: 20px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .button:hover, .btn-follow:hover, .btn-unfollow:hover, .edit-link:hover, .show-link:hover {
      background-color: #004239;
    }

    .btn-follow {
      background-color: #00796b;
    }

    .btn-unfollow {
      background-color: #dc3545;
    }

    .profile-header {
      text-align: center;
      margin-top: 40px;
      margin-bottom: 20px;
      font-size: 18px;
    }

    .posts {
      list-style-type: none;
      padding: 0;
    }

    .post {
      background-color: #fafafa;
      padding: 20px;
      margin-bottom: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .post-body {
      margin-bottom: 15px;
    }

    .post p {
      font-size: 16px;
      color: #555;
      line-height: 1.5;
      word-wrap: break-word;
      overflow-wrap: break-word;
      max-width: 100%;
      overflow: hidden;
    }

    .post-media img {
      width: 100%;
      border-radius: 8px;
      margin-top: 10px;
    }

    @media (max-width: 768px) {
      .profile-container {
        flex-direction: column;
        align-items: center;
      }

      .profile-left, .profile-right {
        width: 100%;
      }

      .profile-description {
        font-size: 16px;
      }

      .button, .btn-follow, .btn-unfollow, .edit-link, .delete-link {
        font-size: 14px;
        padding: 8px 16px;
      }

      .profile-picture {
        width: 150px;
        height: 150px;
      }

      .profile-header {
        font-size: 16px;
      }

      .profile-username {
        font-size: 24px;
      }
    }

      .post-photo img {
        width: 400px;
        height: 300px;
        object-fit: cover; 
        display: block;
 
    }


  </style>
</head>
<body>

 <div class="part">
  <div class="logo">
    <%= link_to 'Paddle', root_path, style: 'text-decoration: none; color: white;' %>
  </div>
  <div class="search-bar">
    <%= search_form_for(@query, url: search_path, method: :get, class: 'search-form') do |f| %>
      <%= f.search_field :body_i_cont_any,
        placeholder: "Search...",
        class: "search-input" %>
      <%= f.submit "🔍", class: "search-button" %>
    <% end %>
  </div>
</div>

<div class="container">
  <br>

  <div class="profile-container">
    <div class="profile-left">
      <div class="profile-picture">
        <% if @user.profile_picture.attached? %>
          <%= image_tag url_for(@user.profile_picture), class: "profile-picture" %>
        <% else %>
          <p>No profile picture uploaded.</p>
        <% end %>
      </div>

      <div class="profile-username">
        <%= @user.username %>
      </div>

      <div class="profile-description">
        <% if @user.profile_description.present? %>
          <p><%= @user.profile_description %></p>
        <% else %>
          <p>This user hasn't added a description yet.</p>
        <% end %>
      </div>
    </div>

    <div class="profile-right">
      <div class="profile-stats">
        <p>
          <%= @user.followers_count %>
          <%= link_to 'Followers', followers_user_path(@user.username) %>
        </p>
        <p>
          <%= @user.following_count %>
          <%= link_to 'Following', following_user_path(@user.username) %>
        </p>
      </div>

      <div class="profile-actions">
        <% if current_user == @user %>
          <%= link_to "Edit Profile", edit_profile_path, class: "button" %>
        <% end %>

        <% if current_user != @user %>
          <% if current_user.following?(@user) %>
            <%= button_to 'Unfollow', unfollow_user_path(@user.username), method: :delete, class: "btn-unfollow" %>
          <% else %>
            <%= button_to 'Follow', follow_user_path(@user.username), method: :post, class: "btn-follow" %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>

  <div class="profile-header">
    <p><%= @user.posts.count %> posts</p>
  </div>

  <% if @user.posts.any? %>
    <ul class="posts">
      <% @user.posts.each do |post| %>
        <li class="post">
          <div class="post-body" id="post-<%= post.id %>">
            <%= simple_format(post.body.gsub(/#\w+/) do |hashtag| 
                  link_to hashtag, tag_path(name: hashtag[1..]), class: "hashtag"
                end.html_safe) %>
          </div>

          <% if post.photo.attached? %>
            <div class="post-photo">
              <%= image_tag(post.photo, class: "post-image") %>
            </div>
          <% end %>

          <div class="actions">
            <%= link_to 'Show', post_path(post), class: 'show-link' %>
            <% if current_user == @user %>
              <%= link_to 'Edit', edit_post_path(post), class: 'edit-link' %>
            <% end %>
          </div>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p><strong>No posts yet. Start creating your first post!</strong></p>
  <% end %>
</div>
